name: Firmware CI

on:
  push:
    branches: [master, main, develop]
    paths:
      - 'firmware/**'
      - '.github/workflows/firmware-ci.yml'
  pull_request:
    branches: [master, main, develop]
    paths:
      - 'firmware/**'
      - '.github/workflows/firmware-ci.yml'

jobs:
  compile:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v4

    - name: Setup Arduino CLI
      uses: arduino/setup-arduino-cli@v2

    - name: Install ESP32 core
      run: |
        arduino-cli core update-index --additional-urls https://raw.githubusercontent.com/espressif/arduino-esp32/gh-pages/package_esp32_index.json
        arduino-cli core install esp32:esp32 --additional-urls https://raw.githubusercontent.com/espressif/arduino-esp32/gh-pages/package_esp32_index.json

    - name: Verify firmware structure
      run: |
        echo "Checking firmware directories..."
        ls -la firmware/
        echo "Firmware structure verified"
